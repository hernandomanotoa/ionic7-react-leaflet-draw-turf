import React from "react";
import {
  MapContainer,
  TileLayer,
  Marker,
  Popup,
  Polygon,
  Polyline,
  Circle,
  Rectangle,
  CircleMarker,
} from "react-leaflet";
import "leaflet/dist/leaflet.css";
import { Icon, LatLngBoundsExpression } from "leaflet";

// Configurar el ícono personalizado para Leaflet
const customIcon = new Icon({
  iconUrl: "https://leafletjs.com/examples/custom-icons/leaf-red.png",
  iconSize: [38, 95],
  iconAnchor: [22, 94],
  popupAnchor: [-3, -76],
});

const MapViewReactLeaflet: React.FC = () => {
  const position: [number, number] = [51.505, -0.09];

  // Punto
  const point: [number, number] = [51.515, -0.1];

  // Línea
  const lineString: [number, number][] = [
    [51.505, -0.09],
    [51.51, -0.08],
    [51.52, -0.06],
  ];

  // Polígono
  const polygon: [number, number][][] = [
    [
      [51.51, -0.12],
      [51.51, -0.13],
      [51.53, -0.13],
    ],
    [
      [51.51, -0.05],
      [51.51, -0.07],
      [51.53, -0.07],
    ],
  ];

  // Rectángulo (Polígono)
  const rectanglePolygon: [number, number][][] = [
    [
      [51.51692870745367, -0.11088817379180682],
      [51.514543120027184, -0.11088817379180682],
      [51.514543120027184, -0.0986309609744751],
      [51.51692870745367, -0.0986309609744751],
      [51.51692870745367, -0.11088817379180682],
    ],
  ];

  // Círculo (Polígono)
  const circlePolygon: [number, number][][] = [
    [
      [51.52583172633802, -0.10327166007320443],
      [51.525818177138405, -0.10371492618271143],
      [51.5257776600498, -0.10415392261222337],
      [51.525710565345165, -0.10458442083127358],
      [51.52561753929887, -0.10500227421099934],
      [51.52549947795828, -0.10540345798518452],
      [51.52535751850835, -0.10578410803439436],
      [51.525193028312614, -0.10614055811878888],
      [51.52500759173641, -0.10646937520030382],
      [51.52480299487956, -0.1067673925134779],
      [51.52458120836581, -0.1070317400660983],
      [51.52434436835536, -0.10725987227581352],
      [51.52409475596338, -0.1074495924766726],
      [51.52383477528332, -0.10759907405991843],
      [51.523566930226856, -0.1077068780459883],
      [51.52329380040396, -0.10777196691923324],
      [51.52301801627534, -0.10779371459302206],
      [51.522742233816906, -0.10777191241028825],
      [51.5224691089404, -0.10770677112284649],
      [51.52220127191644, -0.10759891883157612],
      [51.5219413020463, -0.10744939490846783],
      [51.52169170282627, -0.10725963996018154],
      [51.52145487784357, -0.10703148193079848],
      [51.52123310763588, -0.10676711847850501],
      [51.52102852773677, -0.10646909579666816],
      [51.5208431081183, -0.10614028408381546],
      [51.52067863422863, -0.10578384989909355],
      [51.52053668980645, -0.10540322566955125],
      [51.520418641637804, -0.10500207664279315],
      [51.52032562640143, -0.10458426560292995],
      [51.5202585397293, -0.10415381568908057],
      [51.52021802758708, -0.10371487167376589],
      [51.52020448005765, -0.10327166007320443],
      [51.52021802758708, -0.10282844847264294],
      [51.5202585397293, -0.10238950445732829],
      [51.52032562640143, -0.1019590545434789],
      [51.520418641637804, -0.1015412435036157],
      [51.52053668980645, -0.1011400944768576],
      [51.52067863422863, -0.10075947024731528],
      [51.5208431081183, -0.1004030360625934],
      [51.52102852773677, -0.1000742243497407],
      [51.52123310763588, -0.09977620166790384],
      [51.52145487784357, -0.09951183821561038],
      [51.52169170282627, -0.09928368018622731],
      [51.5219413020463, -0.09909392523794101],
      [51.52220127191644, -0.09894440131483273],
      [51.5224691089404, -0.09883654902356236],
      [51.522742233816906, -0.09877140773612059],
      [51.52301801627534, -0.09874960555338679],
      [51.52329380040396, -0.0987713532271756],
      [51.523566930226856, -0.09883644210042054],
      [51.52383477528332, -0.09894424608649041],
      [51.52409475596338, -0.09909372766973625],
      [51.52434436835536, -0.09928344787059533],
      [51.52458120836581, -0.09951158008031055],
      [51.52480299487956, -0.09977592763293094],
      [51.52500759173641, -0.10007394494610503],
      [51.525193028312614, -0.10040276202761997],
      [51.52535751850835, -0.10075921211201448],
      [51.52549947795828, -0.10113986216122432],
      [51.52561753929887, -0.10154104593540952],
      [51.525710565345165, -0.10195889931513527],
      [51.5257776600498, -0.10238939753418548],
      [51.525818177138405, -0.10282839396369743],
      [51.52583172633802, -0.10327166007320443],
    ],
  ];
  // Rectángulo (Bounds)
  const rectangleBounds: LatLngBoundsExpression = [
    [51.49, -0.08],
    [51.5, -0.06],
  ];

  return (
    <div style={{ height: "100vh", width: "100vw" }}>
      <MapContainer
        center={position}
        zoom={13}
        style={{ height: "100%", width: "100%" }}
      >
        <TileLayer
          url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
          attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        />
        {/* Punto */}
        <CircleMarker center={point} radius={10} color="red">
          <Popup>Punto</Popup>
        </CircleMarker>

        {/* Línea */}
        <Polyline positions={lineString} color="green">
          <Popup>Línea</Popup>
        </Polyline>

        {/* Polígono */}
        <Polygon positions={polygon} color="blue">
          <Popup>Polígono</Popup>
        </Polygon>

        {/* Rectángulo (Polígono) */}
        <Polygon positions={rectanglePolygon} color="orange">
          <Popup>Rectángulo2</Popup>
        </Polygon>

        {/* Círculo (Polígono) */}
        <Polygon positions={circlePolygon} color="purple">
          <Popup>Círculo</Popup>
        </Polygon>
        {/* Rectángulo */}
        <Rectangle bounds={rectangleBounds} color="orange">
          <Popup>Rectángulo1</Popup>
        </Rectangle>
      </MapContainer>
    </div>
  );
};

const App: React.FC = () => {
  return <MapViewReactLeaflet />;
};

export default App;
